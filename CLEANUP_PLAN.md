# üßπ –ü–ª–∞–Ω –æ—á–∏—â–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

## –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –æ—á–∏—â–µ–Ω–∏—è

**–ß—Ç–æ —É–¥–∞–ª—è–µ–º:**
- –î—É–±–ª–∏—Ä—É—é—â–∏–µ —Ñ–∞–π–ª—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ migration —Ñ–∞–π–ª—ã  
- –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ö—É–∫–∏ –∏ —É—Ç–∏–ª–∏—Ç—ã
- Backup —Ñ–∞–π–ª—ã –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã

**–ß—Ç–æ –ù–ï —É–¥–∞–ª—è–µ–º:**
- –†–∞–±–æ—á–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î (–¥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –¥–∞—Ç—ã)
- –§–∞–π–ª—ã —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ —Ç–µ—Å—Ç—ã

---

## üìã –§–ê–ó–ê –û–ß–ò–©–ï–ù–ò–Ø 1: –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤

### 1.1 API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è

**–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**

```bash
# –£–î–ê–õ–ò–¢–¨: –î—É–±–ª–∏—Ä—É—é—â–∏–π —ç–Ω–¥–ø–æ–∏–Ω—Ç
rm app/api/system/sync-users/manual/route.ts
rm -rf app/api/system/sync-users/manual/

# –£–î–ê–õ–ò–¢–¨: –û–¥–∏–Ω –∏–∑ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö sync —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ (–æ—Å—Ç–∞–≤–ª—è–µ–º sync-leaderboard)
# –ü–æ—Å–ª–µ –ø–µ—Ä–µ–Ω–æ—Å–∞ –ª–æ–≥–∏–∫–∏ –≤ –æ–±—â–∏–π —Å–µ—Ä–≤–∏—Å
rm app/api/system/sync-users/route.ts  # –ò–õ–ò sync-leaderboard/route.ts
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:**
- ‚úÖ –í—Å—è –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ –Ω–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- ‚úÖ –í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω—ã –Ω–∞ –Ω–æ–≤—ã–µ API
- ‚úÖ –ü—Ä–æ—à–ª–æ 2+ –Ω–µ–¥–µ–ª–∏ —É—Å–ø–µ—à–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- ‚úÖ –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –∞–∫—Ç–∏–≤–Ω–æ–º –∫–æ–¥–µ

### 1.2 –•—É–∫–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è

**–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ useBranchOperations:**

```bash
# –£–î–ê–õ–ò–¢–¨: –û–¥–∏–Ω –∏–∑ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö —Ö—É–∫–æ–≤
rm hooks/use-branches.tsx         # –ò–õ–ò
rm hooks/use-branch-management.tsx

# –û—Å—Ç–∞–≤–ª—è–µ–º –±–æ–ª–µ–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π, –¥–æ–±–∞–≤–ª—è–µ–º alias –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
```

**–ü–æ–¥—Ö–æ–¥ –∫ —É–¥–∞–ª–µ–Ω–∏—é:**
1. –°–æ–∑–¥–∞—Ç—å `hooks/use-branch-operations.tsx` (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π)
2. –°–æ–∑–¥–∞—Ç—å alias —Ñ–∞–π–ª—ã –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
3. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
4. –ß–µ—Ä–µ–∑ –º–µ—Å—è—Ü —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Ö—É–∫–∏

### 1.3 Utility —Ñ–∞–π–ª—ã –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏

**–£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –≤ —Å–µ—Ä–≤–∏—Å—ã:**

```bash
# –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ lib/services/
rm lib/api/leaderboard.ts  # –ó–∞–º–µ–Ω–µ–Ω –Ω–∞ LeaderboardService
rm lib/api/metrics.ts      # –ó–∞–º–µ–Ω–µ–Ω –Ω–∞ MetricsService  
rm lib/api/system.ts       # –ó–∞–º–µ–Ω–µ–Ω –Ω–∞ SystemService
```

---

## üìã –§–ê–ó–ê –û–ß–ò–©–ï–ù–ò–Ø 2: –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã

### 2.1 Migration —Ñ–∞–π–ª—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è

**–£–¥–∞–ª–∏—Ç—å —á–µ—Ä–µ–∑ 3 –º–µ—Å—è—Ü–∞ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:**

```bash
# –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (—Å–æ–∑–¥–∞–Ω—ã 15.09.2025)
rm supabase/migrations/20250915T150000_fix_branch_architecture.sql
rm supabase/migrations/20250915T150001_fix_branch_architecture_corrected.sql
rm supabase/migrations/20250915T160000_comprehensive_architecture_analysis.sql
rm supabase/migrations/20250915T160001_comprehensive_analysis_fixed.sql
rm supabase/migrations/20250915T160002_simple_analysis.sql
rm supabase/migrations/20250915T160003_step_by_step_analysis.sql
rm supabase/migrations/20250915T170000_fix_duplicate_current_scores.sql
rm supabase/migrations/20250915T180000_fix_recompute_function.sql
rm supabase/migrations/20250915T190000_final_cleanup_duplicates.sql
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π:**
- ‚úÖ –ü—Ä–æ—à–ª–æ 3+ –º–µ—Å—è—Ü–∞ —Å –º–æ–º–µ–Ω—Ç–∞ –¥–µ–ø–ª–æ—è
- ‚úÖ –ë–î —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ –ù–µ—Ç –ø–ª–∞–Ω–æ–≤ –æ—Ç–∫–∞—Ç–∞ –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –≤–µ—Ä—Å–∏—è–º
- ‚úÖ –ï—Å—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –ë–î

### 2.2 Backup –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**–£–¥–∞–ª–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

```bash
# Backup —Ñ–∞–π–ª—ã (—É–∂–µ —É–¥–∞–ª–µ–Ω—ã —á–∞—Å—Ç–∏—á–Ω–æ)
rm app/system/configuration/page.tsx.backup
rm app/teacher/[id]/page\ 2.tsx  
rm app/teacher/[id]/page-new.tsx

# –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏
rm package\ 2.json

# –õ–æ–≥–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
rm server.log

# –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
rm scripts/test-*.js
rm scripts/simplified-*.json
rm scripts/sync-simulation.json
rm scripts/final-integration-report.json
rm scripts/sync-endpoint-test-report.json
rm scripts/test-report.json
```

### 2.3 –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è

**–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö:**

```bash
# –°–∫—Ä–∏–ø—Ç—ã –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã)
rm scripts/add-avatars-to-existing-users.js
rm scripts/apply-fixes.js
rm scripts/check-gravatar.js
rm scripts/cleanup-final.js
rm scripts/create-views.js
rm scripts/fix-database-integrity.ts
rm scripts/fix-info-avatar.js
rm scripts/quick-db-check.js
rm scripts/run-all-tests.js
rm scripts/test-avatars.js
rm scripts/test-db-migration.js
rm scripts/test-final-integration.js
rm scripts/test-pyrus-connection.js
rm scripts/test-pyrus-members.js
rm scripts/test-role-mapping.js
rm scripts/test-simplified-sync.js
rm scripts/test-sync-endpoint.js
rm scripts/test-sync-logic.js
rm scripts/try-all-avatar-services.js
rm scripts/update-all-avatars-with-gravatar-check.js

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:
# - run-integrity-fix.sh (–¥–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤)
# - analyze-dependencies.ts (–¥–ª—è –±—É–¥—É—â–∏—Ö —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–æ–≤)
```

---

## üìã –§–ê–ó–ê –û–ß–ò–©–ï–ù–ò–Ø 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### 3.1 –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

**–ü–æ—Å–ª–µ –ø–µ—Ä–µ–Ω–æ—Å–∞ –≤ –Ω–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**

```bash
# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
mkdir -p lib/services/
mkdir -p lib/clients/
mkdir -p lib/types/shared/

# –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∏ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å
mv lib/api/* lib/clients/  # API –∫–ª–∏–µ–Ω—Ç—ã
mv types/* lib/types/      # –û–±—â–∏–µ —Ç–∏–ø—ã

# –£–¥–∞–ª–∏—Ç—å –ø—É—Å—Ç—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
rmdir lib/api/
rmdir types/ (–µ—Å–ª–∏ –ø—É—Å—Ç–∞—è)
```

### 3.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π –∏–º–ø–æ—Ä—Ç–æ–≤:**

```typescript
// –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–º–ø–æ—Ä—Ç–æ–≤
// scripts/update-imports.ts

// –ó–∞–º–µ–Ω–∏—Ç—å –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö:
// from '@/lib/api/leaderboard' ‚Üí '@/lib/clients/leaderboard.client'
// from '@/lib/api/system' ‚Üí '@/lib/clients/system.client'  
// from '@/hooks/use-branches' ‚Üí '@/hooks/use-branch-operations'
```

### 3.3 –û—á–∏—Å—Ç–∫–∞ package.json

**–£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã
npm audit
npm list --depth=0
npx depcheck

# –£–¥–∞–ª–∏—Ç—å dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–æ—Ç–æ—Ä—ã–µ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã
npm uninstall vitest  # –µ—Å–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ Jest
npm uninstall babel-jest ts-jest  # –æ—Å—Ç–∞–≤–ª—è–µ–º –æ–¥–∏–Ω
```

---

## üìã –§–ê–ó–ê –û–ß–ò–©–ï–ù–ò–Ø 4: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç—ã

### 4.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**–û–±–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:**

```bash
# –û–±–Ω–æ–≤–∏—Ç—å API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é  
docs/branch-management-api.md  # –ù–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
reference.md                   # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
README.md                      # –ï—Å–ª–∏ –µ—Å—Ç—å

# –£–¥–∞–ª–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
rm docs/old-api-reference.md   # –ï—Å–ª–∏ —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å
rm STABILITY_REPORT.md         # –í—Ä–µ–º–µ–Ω–Ω—ã–π –æ—Ç—á–µ—Ç
```

### 4.2 –û—á–∏—Å—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤

**–£–¥–∞–ª–∏—Ç—å baseline —Ç–µ—Å—Ç—ã –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:**

```bash
# –í—Ä–µ–º–µ–Ω–Ω—ã–µ baseline —Ç–µ—Å—Ç—ã
rm tests/integration/api-baseline.test.ts
rm tests/baseline-results.json
rm analysis-results.json
rm REFACTORING_ANALYSIS.md

# –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ production-ready —Ç–µ—Å—Ç—ã
# –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
```

---

## üìã –§–ê–ó–ê –û–ß–ò–©–ï–ù–ò–Ø 5: –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

### 5.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**

```bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —É–¥–∞–ª–µ–Ω–∏—è
npm run lint
npm run test
npm run build

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npx ts-node scripts/check-dependencies.ts

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
npx ts-node scripts/validate-imports.ts
```

### 5.2 –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

**–ü–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π —Ñ–∞–∑–æ–π –æ—á–∏—â–µ–Ω–∏—è:**

```bash
# –°–æ–∑–¥–∞—Ç—å git tag –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
git tag -a cleanup-phase-1 -m "Before cleanup phase 1"
git tag -a cleanup-phase-2 -m "Before cleanup phase 2"
git tag -a cleanup-phase-3 -m "Before cleanup phase 3"

# –°–æ–∑–¥–∞—Ç—å backup –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
tar -czf cleanup-backup-$(date +%Y%m%d).tar.gz \
  app/api/ hooks/ lib/ supabase/migrations/
```

---

## üéØ –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—á–∏—â–µ–Ω–∏—è

### –ß—Ç–æ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ—á–∏—â–µ–Ω–∏—è:

**API —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
app/api/
‚îú‚îÄ‚îÄ auth/[...nextauth]/route.ts
‚îú‚îÄ‚îÄ leaderboard/route.ts         # –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
‚îú‚îÄ‚îÄ metrics/
‚îÇ   ‚îú‚îÄ‚îÄ route.ts
‚îÇ   ‚îî‚îÄ‚îÄ batch-upsert/route.ts
‚îú‚îÄ‚îÄ system/
‚îÇ   ‚îú‚îÄ‚îÄ branches/[id]/route.ts
‚îÇ   ‚îú‚îÄ‚îÄ branches/route.ts
‚îÇ   ‚îú‚îÄ‚îÄ sync-leaderboard/route.ts  # –ï–¥–∏–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ recompute-scores/route.ts
‚îÇ   ‚îî‚îÄ‚îÄ users/route.ts
‚îî‚îÄ‚îÄ teacher/[id]/route.ts
```

**Hooks —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
hooks/
‚îú‚îÄ‚îÄ use-branch-operations.tsx    # –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
‚îú‚îÄ‚îÄ use-leaderboard-data.tsx     # –ù–æ–≤—ã–π
‚îú‚îÄ‚îÄ use-api-state.tsx           # –û–±—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω
‚îú‚îÄ‚îÄ use-mobile.tsx              # –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚îú‚îÄ‚îÄ use-toast.ts                # –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚îî‚îÄ‚îÄ use-user-role.tsx           # –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

**Services —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
lib/
‚îú‚îÄ‚îÄ clients/
‚îÇ   ‚îú‚îÄ‚îÄ leaderboard.client.ts
‚îÇ   ‚îú‚îÄ‚îÄ metrics.client.ts
‚îÇ   ‚îî‚îÄ‚îÄ system.client.ts
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ leaderboard-sync.service.ts
‚îÇ   ‚îú‚îÄ‚îÄ score-recomputation.service.ts
‚îÇ   ‚îî‚îÄ‚îÄ branch.service.ts
‚îî‚îÄ‚îÄ types/
    ‚îî‚îÄ‚îÄ shared/
        ‚îú‚îÄ‚îÄ api.types.ts
        ‚îî‚îÄ‚îÄ leaderboard.types.ts
```

### –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —É–ª—É—á—à–µ–Ω–∏—è:

- **–§–∞–π–ª–æ–≤ —É–¥–∞–ª–µ–Ω–æ:** ~15-20
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞ —É–¥–∞–ª–µ–Ω–æ:** ~800-1000  
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ:** 100%
- **API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ:** 3 ‚Üí 1
- **–•—É–∫–æ–≤ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ:** 2 ‚Üí 1
- **–ú–∏–≥—Ä–∞—Ü–∏–π –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–æ:** 9 –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

### –ß—Ç–æ –ù–ï —É–¥–∞–ª—è—Ç—å –Ω–∏–∫–æ–≥–¥–∞:

1. **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î** (init, core functionality)
2. **–†–∞–±–æ—á–∏–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã** (–¥–∞–∂–µ –µ—Å–ª–∏ –∫–∞–∂—É—Ç—Å—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏)
3. **–§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** (next.config.mjs, tsconfig.json, etc.)
4. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∏–º–ø–æ—Ä—Ç–∞–º–∏**
5. **Backup –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**

### –ü–æ—Ä—è–¥–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è:

1. **–¢–µ—Å—Ç–æ–≤—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã** ‚Üí –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ
2. **–î—É–±–ª–∏—Ä—É—é—â–∏–µ —Ñ–∞–π–ª—ã** ‚Üí –ü–æ—Å–ª–µ 2 –Ω–µ–¥–µ–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è  
3. **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏** ‚Üí –ü–æ—Å–ª–µ 3 –º–µ—Å—è—Ü–µ–≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
4. **–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** ‚Üí –ü–æ—Å–ª–µ –∞—É–¥–∏—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### Rollback –ø–ª–∞–Ω:

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è:

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ git tag
git reset --hard cleanup-phase-1

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup
tar -xzf cleanup-backup-20250915.tar.gz

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
git checkout HEAD~1 -- path/to/deleted/file.ts
```

---

**üìã –≠—Ç–æ—Ç –ø–ª–∞–Ω –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –ø–æ—ç—Ç–∞–ø–Ω–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —Ñ–∞–∑ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã.**
